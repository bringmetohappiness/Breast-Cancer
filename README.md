# Оценка значимости признаков для задачи классификации на примере данных о новообразованиях молочной железы

Этот проект был реализован в рамках выполнения ВКР (выпускной квалификационной работы) магистра и
научной работы в лаборатории управления здравоохранением при Институте Проблем Управления им. В.А.
Трапезникова РАН.

## Набор данных
Датасет был предоставлен в ИПУ. Из себя он представляет 595 заполненных анкет-опросников,
размеченных на 3 класса: «норма», «доброкачественная опухоль» и «злокачественная опухоль». Каждый
по чуть меньше 200 анкет. Как вы могли догадаться, их заполняли женщины, которые проходили
обследование на наличие и характер новообразований молочной железы.

<p align="center">
  <img src="https://raw.githubusercontent.com/mikhailmartin/Breast-Cancer/master/reports/figures/target distribution.png" width="800"/>
</p>

## Структура проекта
```
├── README.md
├── data
|   ├── raw                              <- Исходные Excel-таблички
|   ├── etled                            <- Собранный воедино и почищенный в ходе ETL датасет
|   └── encoded                          <- Осмысленное OrdinalEncoding
├── models                               <- Обученные модели-классификаторы
├── my_ds_tools                          <- Сабмодуль с тулзами
├── notebooks
|   ├── EDA.ipynb                        <- EDA с визуализацией разниц в распределении признаков
|   |                                       между классами. Также здесь исследую примеры с
|   |                                       противоречивыми признаками.
|   ├── DecisionTreeClassifier.ipynb     <- Эксперименты с деревом решений из scikit-learn
|   ├── MyDecisionTreeClassifier.ipynb   <- Эксперименты с собственным деревом решений с
|   |                                       мультисплитами
|   ├── Neural Network.ipynb             <- Эксперименты с персептроном-классификатором с двумя
|   |                                       скрытыми слоями
|   └── CatBoost.ipynb                   <- Эксперименты с GBDT CatBoost
├── src
|   ├── __init__.py
|   ├── constants.py                     <- Константы
|   ├── decision_tree.py                 <- Класс вышеупомянутого собственного дерева решений
|   ├── data
|   |   ├── mini_ETL.py.py               <- ETL на минималках: свожу excel-таблицы в единый датасет,
|   |   |                                   расставляю целевые переменные и исправляю опечатки
|   |   └── meaningful_ordinal_encoding.py  <- Осмысленный OrdinalEncoding ранговых признаков
|   └── models                           <- Скрипты обучения моделей
|       ├── train_catboost_pipe.py
|       ├── train_decision_tree_pipe.py
|       └── train_my_decision_tree_pipe.py
└── win_requirements.txt                 <- Необходимые пакеты для виртуального окружения
```

## Результаты экспериментов
| Модель                         | validation accuracy |
|--------------------------------|---------------------|
| sklearn DecisionTreeClassifier | 0.5942222222222223  |
| MyDecisionTreeClassifier       | 0.5466666666666666  |
| Neural Network                 |                     |
| CatBoost                       | 0.6977777777777778  |

Модель на CatBoost была выбрана в качестве базового классификатора. Оценка значимости признаков
через SHAP значения.

## Интерпретатор и окружение
Я использовал интерпретатор [Python 3.10.7](https://www.python.org/downloads/release/python-3107/).

Рекомендую использовать виртуальное окружение. Его можно создать следующей командой:
```commandline
python -m venv env
```
Все необходимые пакеты собраны в файле `win_requirements.txt`.
Перед установкой пакетов не забудьте активировать виртуальную среду.
Вы можете установить пакеты одной командой:
```commandline
pip install -r win_requirements.txt
```
