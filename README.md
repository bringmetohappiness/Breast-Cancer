# Оценка значимости признаков для задачи классификации на примере данных о новообразованиях молочной железы

Этот проект был реализован в рамках выполнения ВКР (выпускной квалификационной работы) магистра и 
научной работы в лаборатории управления здравоохранением при Институте Проблем Управления им. В.А.
Трапезникова РАН.

## Набор данных
Датасет был предоставлен в ИПУ. Из себя он представляет 595 заполненных анкет-опросников,
размеченных на 3 класса: «норма», «доброкачественная опухоль» и «злокачественная опухоль». Каждый
по чуть меньше 200 анкет. Как вы могли догадаться, их заполняли женщины, которые проходили
обследование на наличие и характер новообразований молочной железы.

## Структура проекта
1. `data` - собственно датасет,
2. `ETL` - собственно ETL на минималках: вооружившись `pandas` свожу excel-таблицы в единый датасет,
расставляю целевые переменные и исправляю опечатки.
3. `EDA` - собственно исследовательский анализ данных с визуализацией разниц в распределении
признаков между классами. Также здесь исследую примеры с противоречивыми признаками.
4. Исследование разных классификаторов:
- `DecisionTreeClassifier` - модель дерева решений из scikit-learn,
- `myDecisionTreeClassifier` - собственная модель дерева решений с мультисплитами,
- `Neural Network` - простейший персептрон с двумя скрытыми слоями,
- `CatBoost` - собственно GBDT CatBoost собственной персоной.
5. В `utils` вынесены
- `constants.py` - константы,
- `decision_tree.py` - класс вышеупомянутого собственного дерева решений,
- `visualization.py` - функции-визуализаторы.

## Результаты экспериментов
| Модель                                                                                                  | accuracy      | precision     | recall        | f1-score      |
|---------------------------------------------------------------------------------------------------------|---------------|---------------|---------------|---------------|
| CatBoost                                                                                                | 0.63 ± 0.032  | 0.62 ± 0.035  | 0.63 ± 0.032  | 0.614 ± 0.039 |
| Нейронная сеть                                                                                          | 0.622 ± 0.022 | 0.612 ± 0.027 | 0.62 ± 0.021  | 0.614 ± 0.024 |
| Собственное дерево решений                                                                              | 0.576 ± 0.031 | 0.455 ± 0.056 | 0.57 ± 0.027  | 0.498 ± 0.24  |
| scikit-learn DecisionTreeClassifier Label Encoding категориальных и ранговых признаков                  | 0.594 ± 0.03  | 0.578 ± 0.034 | 0.588 ± 0.026 | 0.58 ± 0.03   |
| scikit-learn DecisionTreeClassifier Label Encoding ранговых и One-Hot Encoding категориальных признаков | 0.602 ± 0.009 | 0.58 ± 0.022  | 0.594 ± 0.012 | 0.58 ± 0.021  |
| scikit-learn DecisionTreeClassifier One-Hot Encoding категориальных и ранговых признаков                | 0.586 ± 0.04  | 0.572 ± 0.041 | 0.58 ± 0.036  | 0.568 ± 0.038 |
| scikit-learn DecisionTreeClassifier Label Encoding ранговыx и Target Encoding категориальных признаков  | 0.582 ± 0.021 | 0.564 ± 0.028 | 0.574 ± 0.02  | 0.56 ± 0.028  |
| scikit-learn DecisionTreeClassifier Label Encoding категориальных и ранговых признаков                  | 0.556 ± 0.007 | 0.548 ± 0.013 | 0.556 ± 0.007 | 0.546 ± 0.016 |

Соответственно модель на CatBoost была выбрана в качестве базового классификатора. Оценка значимости
признаков через SHAP значения.

## Интерпретатор и окружение
Я использовал интерпретатор [Python 3.10.7](https://www.python.org/downloads/release/python-3107/).

Рекомендую использовать виртуальное окружение. Его можно создать следующей командой:
```
python -m venv env
```
Все необходимые пакеты собраны в файле `win_requirements.txt`.
Перед установкой пакетов не забудьте активировать виртуальную среду.
Вы можете установить пакеты одной командой:
```
pip install -r win_requirements.txt
```
